table(subject, cellTypes)
table(cond, cellTypes)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("percentile", "BCa", "multinom"),
nboot = 50)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("percentile", "BCa", "multinom"),
nboot = 1000)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("percentile", "BCa", "multinom"),
nboot = 10000)
View(haber_model)
View(res_scDC_noClust)
View(res_scDC_noClust$results)
res_GLM <- fitGLM(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"),
pairwise = FALSE)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("percentile", "BCa", "multinom"),
nboot = 10)
res_GLM <- fitGLM(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"),
pairwise = FALSE)
summary(res_GLM$pool_res_fixed)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("percentile", "BCa", "multinom"),
nboot = 100)
res_GLM <- fitGLM(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"),
pairwise = FALSE)
summary(res_GLM$pool_res_fixed)
summary(res_GLM$pool_res_random)
table(cond, cellTypes)
sim$sim_cellTypes
sim$sim_subject
sim$sim_cond
table(subject, cellTypes)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("percentile", "BCa", "multinom"),
nboot = 100)
library(scdney)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("percentile", "BCa", "multinom"),
nboot = 100)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
res_GLM <- fitGLM(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"),
pairwise = FALSE)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
res_GLM <- fitGLM(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"),
pairwise = FALSE)
summary(res_GLM$pool_res_fixed)
summary(res_GLM$pool_res_random)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
res_GLM <- fitGLM(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"),
pairwise = FALSE, ncores=8)
View(sim)
res_scDC_noClust <- scDC_clustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
res_scDC_noClust <- scDC_clustering(expresMat, cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
exprsMat <- sim$sim_exprsMat
subject <- sim$sim_subject
cellTypes <- sim$sim_cellTypes
cond <- sim$sim_cond
res_scDC_noClust <- scDC_clustering(expresMat, cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
res_scDC_noClust <- scDC_clustering(exprsMat, cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
warnings()
res_scDC_noClust <- scDC_clustering(exprsMat, cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000, ncores=8)
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
barplotCI(res_scDC_clust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2")))
barplotCI(res_scDC_clust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"))
barplotCI(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"))
densityCI(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"))
res_GLM <- fitGLM(res_scDC_noClust, c("cond1","cond1","cond1","cond1",
"cond2","cond2","cond2","cond2"),
pairwise = FALSE)
summary(res_GLM$pool_res_fixed)
summary(res_GLM$pool_res_random)
table(subject, cellTypes)
cellTypes
subject
gen_test_cells = [[211., 175.,  269., 179., 166.], [228., 170., 166., 224., 212.],
[219., 133., 196., 275., 177.], [270., 173., 284., 129., 144.],
[365., 140., 152., 189., 154.], [300., 198.,  93., 279., 130.]]
gen_test_cells = array([[211., 175.,  269., 179., 166.], [228., 170., 166., 224., 212.],
[219., 133., 196., 275., 177.], [270., 173., 284., 129., 144.],
[365., 140., 152., 189., 154.], [300., 198.,  93., 279., 130.]])
install.packages("tidyverse")
library(tidyverse)
gen_test_cells = matrix(data=c(211., 175.,  269., 179., 166, 228., 170., 166., 224., 212.,
219., 133., 196., 275., 177., 270., 173., 284., 129., 144.,
365., 140., 152., 189., 154., 300., 198.,  93., 279., 130.),
ncol=5)
gen_test_cells
cellTypes
for(i in c(1:5)){
i
}
paste(i)
for(i in c(1:5)){
paste(i)
}
ct = "Type_" + str(i)
cell_counts = c(211., 175.,  269., 179., 166, 228., 170., 166., 224., 212.,
219., 133., 196., 275., 177., 270., 173., 284., 129., 144.,
365., 140., 152., 189., 154., 300., 198.,  93., 279., 130.)
gen_test_cells = matrix(data=cell_counts,
ncol=5)
paste0(n)
for(n in cell_counts){
paste0(n)
}
for(n in cell_counts){
paste(n)
}
for(n in cell_counts){
print(n)
}
for(n in c(1:30)){
print(n)
}
print(cell_counts[n])
for(n in c(1:30)){
print(cell_counts[n])
}
for(n in c(1:30)){
current_cell_type <- cellTypes[n%%5]
print(current_cell_type)
}
for(n in c(1:30)){
current_cell_type <- cell_Types[n%%5]
print(current_cell_type)
}
subjects <- c("s1_cont", "s2_cont", "s3_cont", "s1_case", "s2_case", "s3_case")
cell_Types <- c("C1", "C2", "C3", "C4", "C5")
for(n in c(1:30)){
current_cell_type <- cell_Types[n%%5]
print(current_cell_type)
}
for(n in c(1:30)){
current_cell_type <- cell_Types[(n%%5)+1]
print(current_cell_type)
}
for(n in c(1:30)){
current_cell_type <- cell_Types[(n-1%%5)+1]
print(current_cell_type)
}
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
print(current_cell_type)
}
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
}
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
pritn(current_subject)
}
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
print(current_subject)
}
print(current_condition)
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
current_condition <- ifelse(n<=15, "control", "case")
print(current_condition)
}
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
current_condition <- ifelse(n<=15, "control", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
test_cellTypes <- c()
test_subject <- c()
test_cond <- c()
subjects <- c("s1_cont", "s2_cont", "s3_cont", "s1_case", "s2_case", "s3_case")
cell_Types <- c("C1", "C2", "C3", "C4", "C5")
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
current_condition <- ifelse(n<=15, "control", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
table(test_subject, test_cellTypes)
table(test_cond, test_cellTypes)
test_res_scDC_noClust <- scDC_clustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("percentile", "multinom"),
nboot = 10000)
exprsMat
test_res_scDC_noClust <- scDC_clustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("multinom"),
nboot = 10000)
test_res_scDC_noClust <- scDC_noClustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("BCa")
nboot = 10000)
test_res_scDC_noClust <- scDC_noClustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("BCa")
nboot = 10000)
test_res_scDC_noClust <- scDC_noClustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
cc_vec <- rep(c(rep("case", 5), rep("control", 5)), 6)
print(cc_vec)
barplotCI(test_res_scDC_noClust, cc_vec)
cc_vec <- rep(c(rep("case", 5), rep("control", 5)), 3)
print(cc_vec)
barplotCI(test_res_scDC_noClust, cc_vec)
densityCI(test_res_scDC_noClust, cc_vec)
res_GLM <- fitGLM(test_res_scDC_noClust, cc_vec,
pairwise = FALSE)
test_res_scDC_noClust <- scDC_noClustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
cc_vec <- rep(c(rep("case", 5), rep("control", 5)), 3)
print(cc_vec)
barplotCI(test_res_scDC_noClust, cc_vec)
densityCI(test_res_scDC_noClust, cc_vec)
res_GLM <- fitGLM(test_res_scDC_noClust, cc_vec,
pairwise = FALSE)
summary(res_GLM$pool_res_fixed)
summary(res_GLM$pool_res_random)
library(tidyverse)
cell_counts <- c(211., 175.,  269., 179., 166, 228., 170., 166., 224., 212.,
219., 133., 196., 275., 177., 270., 173., 284., 129., 144.,
365., 140., 152., 189., 154., 300., 198.,  93., 279., 130.)
gen_test_cells <- matrix(data=cell_counts,
ncol=5)
test_cellTypes <- c()
test_subject <- c()
test_cond <- c()
subjects <- c("base_s1", "base_s2", "bas_s3", "case_s1", "case_s2", "case_s3")
cell_Types <- c("C1", "C2", "C3", "C4", "C5")
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
current_condition <- ifelse(n<=15, "control", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
table(test_subject, test_cellTypes)
table(test_cond, test_cellTypes)
subjects <- c("base_s1", "base_s2", "base_s3", "case_s1", "case_s2", "case_s3")
cell_Types <- c("C1", "C2", "C3", "C4", "C5")
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
current_condition <- ifelse(n<=15, "control", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
table(test_subject, test_cellTypes)
test_cellTypes <- c()
test_subject <- c()
test_cond <- c()
subjects <- c("base_s1", "base_s2", "base_s3", "case_s1", "case_s2", "case_s3")
cell_Types <- c("C1", "C2", "C3", "C4", "C5")
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
current_condition <- ifelse(n<=15, "control", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
table(test_subject, test_cellTypes)
table(test_cond, test_cellTypes)
test_res_scDC_noClust <- scDC_noClustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
cc_vec <- rep(c(rep("case", 5), rep("control", 5)), 3)
print(cc_vec)
barplotCI(test_res_scDC_noClust, cc_vec)
densityCI(test_res_scDC_noClust, cc_vec)
res_GLM <- fitGLM(test_res_scDC_noClust, cc_vec,
pairwise = FALSE)
cc_vec <- c(rep("control", 15), rep("case", 15))
print(cc_vec)
barplotCI(test_res_scDC_noClust, cc_vec)
print(current_subject)
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
print(current_subject)
current_condition <- ifelse(n<=15, "control", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
table(test_subject, test_cellTypes)
test_cellTypes <- c()
test_subject <- c()
test_cond <- c()
subjects <- c("base_s1", "base_s2", "base_s3", "case_s1", "case_s2", "case_s3")
cell_Types <- c("C1", "C2", "C3", "C4", "C5")
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
print(current_subject)
current_condition <- ifelse(n<=15, "control", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
table(test_subject, test_cellTypes)
table(test_cond, test_cellTypes)
test_cellTypes <- c()
test_subject <- c()
test_cond <- c()
subjects <- c("base_s1", "base_s2", "base_s3", "case_s1", "case_s2", "case_s3")
cell_Types <- c("C1", "C2", "C3", "C4", "C5")
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
print(current_subject)
current_condition <- ifelse(n<=15, "base", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
table(test_subject, test_cellTypes)
table(test_cond, test_cellTypes)
cell_counts <- c(211., 175.,  269., 179., 166, 228., 170., 166., 224., 212.,
219., 133., 196., 275., 177., 377., 147., 244., 109., 123.,
486., 114., 125., 152., 123., 411., 168., 78., 235., 108.)
gen_test_cells <- matrix(data=cell_counts,
ncol=5)
test_cellTypes <- c()
test_subject <- c()
test_cond <- c()
subjects <- c("base_s1", "base_s2", "base_s3", "case_s1", "case_s2", "case_s3")
cell_Types <- c("C1", "C2", "C3", "C4", "C5")
for(n in c(1:30)){
current_cell_type <- cell_Types[((n-1)%%5)+1]
current_subject <- subjects[((n-1)%/%5)+1]
print(current_subject)
current_condition <- ifelse(n<=15, "base", "case")
test_cellTypes <- c(test_cellTypes, rep(current_cell_type, cell_counts[n]))
test_subject <- c(test_subject, rep(current_subject, cell_counts[n]))
test_cond <- c(test_cond, rep(current_condition, cell_counts[n]))
}
table(test_subject, test_cellTypes)
table(test_cond, test_cellTypes)
test_res_scDC_noClust <- scDC_noClustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
cc_vec <- c(rep("control", 15), rep("case", 15))
print(cc_vec)
barplotCI(test_res_scDC_noClust, cc_vec)
res_GLM <- fitGLM(test_res_scDC_noClust, cc_vec,
pairwise = FALSE)
summary(res_GLM$pool_res_fixed)
summary(res_GLM$pool_res_random)
library(scdney)
summary(res_GLM$pool_res_fixed)
summary(res_GLM$pool_res_random)
barplotCI(test_res_scDC_noClust, cc_vec)
densityCI(test_res_scDC_noClust, cc_vec)
subject
cond
summary(res_GLM$pool_res_fixed)
summary(res_GLM$pool_res_random)
test_res_scDC_noClust <- scDC_noClustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
# devtools::install_github("SydneyBioX/scdney", build_opts = c("--no-resave-data", "--no-manual"))
library(scdney)
test_res_scDC_noClust <- scDC_noClustering(test_cellTypes, test_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
res_GLM <- fitGLM(test_res_scDC_noClust, cc_vec,
pairwise = FALSE)
setwd(this.dir)
this.dir <- dirname(parent.frame(2)$ofile)
print(parent.frame(2))
setwd(getSrcDirectory()[1])
source('~/Uni/Master\'s_Thesis/compositionalDiff-johannes_tests_2/paper_simulation_scripts/scdc_r_data/scdney_server_script.R')
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
# Load data
cellTypes = readLines("./scdc_cellTypes")
# Load data
py_cellTypes = readLines("scdc_cellTypes")
# Load data
py_cellTypes = readLines(getwd() + "/scdc_cellTypes")
# Load data
py_cellTypes = read.delim("./scdc_cellTypes")
# Load data
py_cellTypes = read.delim("scdc_cellTypes")
getwd()
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt")
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = None)$
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = None)
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = FALSE)
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = FALSE)§V1
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = FALSE)$V1
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = FALSE, as.is=TRUE)$V1
py_condition = read.delim("scdc_condition.txt", header = FALSE, as.is=TRUE)$V1
py_subject = read.delim("scdc_subject.txt", header = FALSE, as.is=TRUE)$V1
res_scDC_noClust <- scDC_noClustering(cellTypes, subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 10000)
py_res_scDC_noClust <- scDC_noClustering(py_cellTypes, py_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
py_short_subjects = read.delim("scdc_short_subjects.txt", header = FALSE, as.is=TRUE)$V1
py_res_GLM <- fitGLM(py_res_scDC_noClust, py_short_subjects),
pairwise = FALSE)
py_res_GLM <- fitGLM(py_res_scDC_noClust, py_short_subjects, pairwise = FALSE)
summary(py_res_GLM$pool_res_fixed)
summary(py_res_GLM$pool_res_random)
barplotCI(py_test_res_scDC_noClust, py_short_subjects)
barplotCI(py_test_res_scDC_noClust, py_short_subjects)
py_res_scDC_noClust <- scDC_noClustering(py_cellTypes, py_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
barplotCI(py_test_res_scDC_noClust, py_short_subjects)
barplotCI(py_res_scDC_noClust, py_short_subjects)
py_short_conditions = read.delim("scdc_short_conditions", header = FALSE, as.is=TRUE)$V1
py_short_conditions = read.delim("scdc_short_conditions.txt", header = FALSE, as.is=TRUE)$V1
py_res_scDC_noClust <- scDC_noClustering(py_cellTypes, py_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
barplotCI(py_res_scDC_noClust, py_short_conditions)
densityCI(py_res_scDC_noClust, py_short_conditions)
py_res_GLM <- fitGLM(py_res_scDC_noClust, py_short_conditions, pairwise = FALSE)
summary(py_res_GLM$pool_res_fixed)
summary(py_res_GLM$pool_res_random)
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = FALSE, as.is=TRUE)$V1
py_subject = read.delim("scdc_subject.txt", header = FALSE, as.is=TRUE)$V1
py_condition = read.delim("scdc_condition.txt", header = FALSE, as.is=TRUE)$V1
py_short_conditions = read.delim("scdc_short_conditions.txt", header = FALSE, as.is=TRUE)$V1
py_res_scDC_noClust <- scDC_noClustering(py_cellTypes, py_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
barplotCI(py_res_scDC_noClust, py_short_conditions)
densityCI(py_res_scDC_noClust, py_short_conditions)
py_res_GLM <- fitGLM(py_res_scDC_noClust, py_short_conditions, pairwise = FALSE)
summary(py_res_GLM$pool_res_fixed)
summary(py_res_GLM$pool_res_random)
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = FALSE, as.is=TRUE)$V1
py_subject = read.delim("scdc_subject.txt", header = FALSE, as.is=TRUE)$V1
py_condition = read.delim("scdc_condition.txt", header = FALSE, as.is=TRUE)$V1
py_short_conditions = read.delim("scdc_short_conditions.txt", header = FALSE, as.is=TRUE)$V1
py_res_scDC_noClust <- scDC_noClustering(py_cellTypes, py_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
barplotCI(py_res_scDC_noClust, py_short_conditions)
densityCI(py_res_scDC_noClust, py_short_conditions)
py_res_GLM <- fitGLM(py_res_scDC_noClust, py_short_conditions, pairwise = FALSE)
summary(py_res_GLM$pool_res_fixed)
summary(py_res_GLM$pool_res_random)
# Load data
py_cellTypes = read.delim("scdc_cellTypes.txt", header = FALSE, as.is=TRUE)$V1
py_subject = read.delim("scdc_subject.txt", header = FALSE, as.is=TRUE)$V1
py_condition = read.delim("scdc_condition.txt", header = FALSE, as.is=TRUE)$V1
py_short_conditions = read.delim("scdc_short_conditions.txt", header = FALSE, as.is=TRUE)$V1
py_res_scDC_noClust <- scDC_noClustering(py_cellTypes, py_subject, calCI = TRUE,
calCI_method = c("BCa"),
nboot = 100)
barplotCI(py_res_scDC_noClust, py_short_conditions)
densityCI(py_res_scDC_noClust, py_short_conditions)
py_res_GLM <- fitGLM(py_res_scDC_noClust, py_short_conditions, pairwise = FALSE)
summary(py_res_GLM$pool_res_fixed)
summary(py_res_GLM$pool_res_random)
write.csv(summary(py_res_GLM$pool_res_random), "scdc_summary.csv")
